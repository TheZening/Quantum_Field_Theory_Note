%==============================
%==============================
\chapter{记号, 约定和物理背景}
\label{CH1: Notation convention and physical background}
%==============================
%==============================
量子场论, Quantum Field Theory, 的发展可概括为四个关键阶段:在1920--1930年代,克莱因--高登 (Klein--Gordon) 方程与狄拉克 (Dirac) 方程首次将相对论与量子化思想结合,标志着二次量子化的萌芽——场算符、创生与湮灭算符以及反粒子概念由此诞生.
进入1940--1950年代, 汤川秀树 (Tomonaga) , 施温格 (Schwinger) 和费曼 (Feynman) 各自独立发展出重整化 (renormalization) 方案, 系统地消除量子电动力学 (QED) 微扰展开过程中的紫外发散, 使QED成为精度可达 $10^{-8}$ 的``量子天堂”, 同时费曼图 (Feynman Diagram) 的引入将复杂的多粒子过程可视化, 算法化, 显著简化了高阶微扰计算.
在1960--1970年代, 杨振宁 (Yang) 与罗德里克.米尔斯 (Mills) 提出非阿贝尔规范场论 (Yang--Mills Theory), 随后谢尔顿.格拉肖 (Glashow), 史蒂文.温伯格 (Weinberg) 与阿卜杜勒.萨拉姆 (Salam) 完成电弱统一 (Electroweak Unification), 并由大卫.阿斯庞德 (Gross), 弗兰克.威尔契克 (Wilczek) 与大卫.波利策 (Politzer) 各自揭示了量子色动力学 (QCD) 的渐近自由 (asymptotic freedom) 特性, 奠定了标准模型 (Standard Model) 的核心框架.


从1970年代末至今, 肯.威尔逊 (K.G.Wilson) 系统化了重整化群 (Renormalization Group, RG) 方法, 提出``流线”与``固定点”思想, 并倡导有效场论 (Effective Field Theory, EFT) 理念, 强调在不同能标下仅保留低能自由度构建拉氏量, 而格点量子场论 (Lattice QFT) 配合蒙特卡罗数值模拟则成为研究强耦合态 (如强子谱与相变) 的主要非微扰手段.


此外,拓扑量子场论 (Topological QFT) 与Seiberg-Witten对偶、Witten索引等成果拓宽了场论与几何拓扑的交叉研究
量子场论的核心思想包括: 一是二次量子化, 将场函数升格为算符, 粒子创生与湮灭操作使粒子数不再守恒.
二是微扰展开与费曼图技术, 以耦合常数为小参量, 借费曼规则系统枚举相互作用贡献.
三是重整化与重整化群, 通过引入重整化常数消除紫外发散,并用Callan--Symanzik方程描述物理量随重整化标度的演化.
四是非微扰方法, 如$1/N$ 展开, 复制场论 (Replica Field Theory) 及格点模拟, 专攻强耦合和非平衡问题.
五是拓扑, 对偶与几何方法, 借助拓扑不变量, 莫德尔对偶和几何Langlands等数学工具, 揭示规范场论的相结构与对偶对称.


近期进展方面, 二维共形场论 (CFT) 在统计物理与高能物理的交汇处取得重要突破, 保罗.贝尔切坚 (Belavin), 亚历山大.波利亚科夫 (Polyakov) 构建的严格解析框架促进了临界现象研究.
1997年,胡安.马尔达西纳 (Maldacena) 提出的AdS/CFT 对偶为非微扰场论与引力提供了全新联系.
与此同时, 量子信息理论中的纠缠熵度量成为探讨量子场论相变与时空结构的新工具, 量子模拟实验 (冷原子与超导量子比特平台) 也在实时时演化模拟和非平衡动力学研究中取得长足进展.


总之, 量子场论从对基本粒子相互作用的首要描述发展为涵盖数学, 信息, 数值与实验多领域交叉的宏大理论体系, 既奠定了现代粒子物理与凝聚态物理的根基, 也持续通过新技术与新观念深化我们对微观规律的认识.


%====================
%====================
\section{记号和约定}
\label{CH1 S1 Notation and convention}
%====================
%====================
明确记号和约定可以帮助我们更清晰的交流和理解物理概念.
除非我们特别提示, 否则以下记号和约定在本书中均适用.
首先我们约定记号, 对于一个任意标量, 我们使用正常的英文字母:
\begin{equation}
  a,\, b,\, c, \ldots
\end{equation}
对于一个三维空间的向量, 我们使用粗体字母, 对于三维向量的Catesian分量, 我们使用下标
\begin{equation}
  \bm{A} = (A_x, A_y, A_z) \quad \bm{p} = (p_x, p_y, p_z)
\end{equation}
\fr{我们不会特意的给向量加一个箭头}.
如果我们考虑的是四维时空的向量, 我们还是使用一个正常英文字母, 对于协变分量 (co-variant component), 我们使用\fr{下标}, 对于逆变分量 (contra-variant), 我们使用\fr{上标}:
\begin{equation}
  A_\mu = (A_0, A_1, A_2, A_3) \quad A^\mu = (A^0, A^1, A^2, A^3)
\end{equation}
我们的Minkowski时空的度规张量是:
\begin{equation}
  g_{\mu\nu} = \begin{pmatrix}
    1 & 0 & 0 & 0 \\
    0 & -1 & 0 & 0 \\
    0 & 0 & -1 & 0 \\
    0 & 0 & 0 & -1
  \end{pmatrix} \quad
  g^{\mu\nu} = \begin{pmatrix}
    1 & 0 & 0 & 0 \\
    0 & -1 & 0 & 0 \\
    0 & 0 & -1 & 0 \\
    0 & 0 & 0 & -1
  \end{pmatrix}
\end{equation}
从而我们可以立刻对4-向量进行升降:
\begin{equation}
  x_\mu = g_{\mu\nu} x^\nu = (x_0, -x_1, -x_2, -x_3) = (t, -x, -y, -z) = (x^0, -\bm{x})
\end{equation}
然后我们约定, 逆协变向量可以写为:
\begin{equation}
  A^\mu = (A^0, A^1, A^2, A^3) \equiv (A_t, A_x, A_y, A_z) = (A_t, \bm{A}) = (A^0, \bm{A})
\end{equation}
根据Einstein求和约定, 上标和下标相同的分量会被求和, 例如:
\begin{equation}
  A_\mu B^\mu = A_0 B^0 + A_1 B^1 + A_2 B^2 + A_3 B^3
\end{equation}
所以我们可以明确的区分不同形式的张量.
比如(1,1)-型张量, (0,2)-型张量, (2,0)-型张量分别写为:
\begin{equation}
  T^\mu_\nu \quad T_{\mu\nu} \quad T^{\mu\nu}
\end{equation}
只要按照正常的Einstein求和约定缩并即可.
当然了, 一个矩阵作为线性映射一般是(1,1)-型张量, 如果看成是双线性映射, 那么它是(0,2)-型张量. %注解
对于协变-逆变指标, 我们严格按照如下顺序使用:
\begin{equation}
  \mu, \nu, \rho, \sigma, \eta, \lambda, \zeta
\end{equation}
如果需要的比这个还多, 我们会格外提示.
另外, 因为密度这个物理量绝对不会出现在角标上, 所以我们不会对角标和物理量作为区分, 一般常用的物理量不会改变意义, 比如$\rho$表示密度, $\sigma_{0,1,2,3}$是Pauli矩阵, $\epsilon_{ijk}$是Levi-Civita符号, $\mu_B$ 是Bohr磁子, $\hbar$ 是约化Planck常数, $c$ 是光速, $k_B$ 是Boltzmann常数, $e$ 是电子电荷, $m_e$ 是电子质量, $m_p$ 是质子质量, $m_n$ 是中子质量, $M_W$ 是W玻色子质量, $M_Z$ 是Z玻色子质量, $M_H$ 是希格斯玻色子质量, $\alpha$ 是精细结构常数, $\Lambda_{\text{QCD}}$ 是量子色动力学的标度参数.


对于一个波函数, 我们使用$\psi$来表示:
\begin{equation}
  \psi(\bm{x}; t) = \braket{\bm{x}}{\psi; t}
\end{equation}
是态$\ket{\psi; t}$在位置基上的投影, 而时间在量子力学中是一个参数, 所以我们单独使用分号区别开来.
对于一个场, 我们使用$\phi$来表示, 因为场是是时间-空间的函数, 所以我们使用括号来表示:
\begin{equation}
  \phi(t, x, y, z) = \phi(x^\mu) = \phi(x^0, x^1, x^2, x^3) = \phi(x^0, \bm{x}) = \phi(t, \bm{x})
\end{equation}
除了有时空分量以外, 我们还要处理旋量, spinor, 用$\chi$来表示, 另外, 我们明确区分列向量与行向量, 所以我们有:
\begin{equation}
  \chi = [1 ,0 ,0 ,0]^T \quad \chi^\dagger = [1 ,0 ,0 ,0]
\end{equation}
来标记.
对于有极化方向的物理量, 比如光, 比如声子, 我们要考虑极化向量, 我们使用如下的记号, 他仍然有四个分量:
\begin{equation}
  \varepsilon^\mu(k^\mu, \lambda)
\end{equation}
其中$k^\mu$是4-波向量, $\lambda$是极化方向的标号, 具体的意义会在量子电动力学中给明.

对于量子场论中的算符, 我们同意使用$\hat{}$来标记, 比如湮灭-创生算子分别是:
\begin{equation}
  \hat{a} \quad \hat{a}^\dagger
\end{equation}
他们作用在Fock态上, 记作:
\begin{equation}
  \ket{1, 1, 0, 0, 0, ,1, \cdots}
\end{equation}
我们不解释他们的来源和物理意义, 留待各个章节讨论, 这里只是规定记号.
其余一切和量子力学有关的, 都是正常的Dirac记号.

对于Fourier变换, 我们使用如下的记号, 从时间变量开始:
\begin{equation}
  \tilde{f}(\omega) = \int_{-\infty}^{+\infty} f(t) e^{\fr{+}\mathrm{i}\, \omega t} \dd{t} \Leftrightarrow
  f(t) = \int_{-\infty}^{+\infty} \tilde{f}(\omega) e^{-\mathrm{i}\, \omega t} \dd{\omega}
\end{equation}
另外我们强调一下, $\mathrm{i}\,$是虚数, $i$可能是一个角标的索引, 我们作出严格区分避免混淆.
然后是空间上的Fourier变换:
\begin{equation}
  \tilde{f}(\bm{k}) = \int_{\mathbb{R}^3} f(\bm{x}) e^{-\mathrm{i}\, \bm{k} \cdot \bm{x}} \dd[3]{x} \Leftrightarrow
  f(\bm{x}) = \int_{\mathbb{R}^3} \tilde{f}(\bm{k}) e^{+\mathrm{i}\, \bm{k} \cdot \bm{x}} \dd[3]{k}
\end{equation}
从而我们有4维时空的整体Fourier变换:
\begin{equation}
  \tilde{f}(k) = \int_{\mathbb{R}^4} f(x) e^{-\mathrm{i}\, k \cdot x} \dd[4]{x} \Leftrightarrow
  f(x) = \int_{\mathbb{R}^4} \tilde{f}(k) e^{+\mathrm{i}\, k \cdot x} \dd[4]{k}
\end{equation}
注意, 这里的$k$是4-波向量, $x$是4-位置向量, 我们遇到他们两个缩并的时候, 我们省略指标, 但是明确的写出那个``$\cdot$", 实际上, 上面的式子意思是:
\begin{equation}
 k\cdot x \equiv k^\mu x_\mu = k^0 x^0 - \bm{k} \cdot \bm{x} = \omega t - \bm{k} \cdot \bm{x} = \omega t - k_x x - k_y y - k_z z
\end{equation}


另外一个和Fourier变换非常相关的一个恒等式是$\delta$函数的定义.
我们还是从时间变量开始:
\begin{equation}
  \delta(t-t_0) = \int_{-\infty}^{+\infty} e^{-\mathrm{i}\, \omega (t - t_0)} \dd{\omega}
\end{equation}
同时也有:
\begin{equation}
  \delta(\omega-\omega_0) = \int_{-\infty}^{+\infty} e^{-\mathrm{i}\, t (\omega-\omega_0)} \dd{t}
\end{equation}
从空间变量出发, 我们可以定义:
\begin{equation}
  \delta^{(3)}(\bm{x}-\bm{x}_0) = \int_{\mathbb{R}^3} e^{+\mathrm{i}\, \bm{k} \cdot (\bm{x} - \bm{x}_0)} \dd[3]{k}
\end{equation}
当然反过来就是关于$\bm{k}$的:
\begin{equation}
  \delta^{(3)}(\bm{k}-\bm{k}_0) = \int_{\mathbb{R}^3} e^{+\mathrm{i}\, \bm{x} \cdot (\bm{k} - \bm{k}_0)} \dd[3]{x}
\end{equation}
综合起来, 我们有:
\begin{equation}
  \delta^{(4)}(x-x_0) = \int_{\mathbb{R}^4} e^{+\mathrm{i}\, k \cdot (x - x_0)} \dd[4]{k}
\end{equation}
\begin{equation}
  \delta^{(4)}(k-k_0) = \int_{\mathbb{R}^4} e^{+\mathrm{i}\, x \cdot (k - k_0)} \dd[4]{x}
\end{equation}
我们必须明确的指定$\delta^{(n)}$的维度, 其中$n$是维度.
同样的, 还有Fourier级数:
\begin{equation}
  f(\bm{x}) = \frac{1}{\sqrt{L_x L_y L_z}} \sum_{n_x=-\infty}^{+\infty} \sum_{n_y=-\infty}^{+\infty} \sum_{n_z=-\infty}^{+\infty} \tilde{f}_{n_x n_y n_z} e^{+\mathrm{i}\, \frac{2\pi}{L} (n_x x + n_y y + n_z z)}
\end{equation}
\begin{equation}
  \tilde{f}_{n_x n_y n_z} = \frac{1}{\sqrt{L_x L_y L_z}} \int_0^{L_x} \int_0^{L_y} \int_0^{L_z} f(\bm{x}) e^{-\mathrm{i}\, \frac{2\pi}{L} (n_x x + n_y y + n_z z)} \dd[3]{x}
\end{equation}
从而我们有:
\begin{equation}
  \delta(\bm{x}-\bm{x}_0) = \frac{1}{L_x L_y L_z} \sum_{n_x=-\infty}^{+\infty} \sum_{n_y=-\infty}^{+\infty} \sum_{n_z=-\infty}^{+\infty} e^{\mathrm{i}\, \frac{2\pi}{L} (n_x (x-x_0) + n_y (y-y_0) + n_z (z-z_0))}
\end{equation}


接下来我们规定导数的几号, 我们的协变导数为:
\begin{equation}
  \partial_\mu = \frac{\partial}{\partial x^\mu} = \left( \frac{\partial}{\partial x^0}, \frac{\partial}{\partial x^1}, \frac{\partial}{\partial x^2}, \frac{\partial}{\partial x^3} \right) = \left( \frac{\partial}{\partial t}, \frac{\partial}{\partial x}, \frac{\partial}{\partial y}, \frac{\partial}{\partial z} \right) = \left(\pdv{}{x^0}, \nabla\right)
\end{equation}
其中$\nabla$是空间的梯度算符, 也就是:
\begin{equation}
  \nabla = \left( \frac{\partial}{\partial x}, \frac{\partial}{\partial y}, \frac{\partial}{\partial z} \right) = \left( \pdv{}{x^1}, \pdv{}{x^2}, \pdv{}{x^3} \right)
\end{equation}
从而我们获得逆变导数:
\begin{equation}
  \partial^\mu = g^{\mu\nu} \partial_\nu = \left( \frac{\partial}{\partial x^0}, -\frac{\partial}{\partial x^1}, -\frac{\partial}{\partial x^2}, -\frac{\partial}{\partial x^3} \right)= \left( \pdv{}{x^0}, \pdv{}{x_1}, \pdv{}{x_2}, \pdv{}{x_3} \right) = \left( \pdv{}{x^0}, -\nabla \right) 
\end{equation}


现在我们讨论一下单位制的问题, 在国际单位制中, 我们有:
\begin{table}[h!]
\centering
\begin{tabular}{|l|l|l|}
  \hline
  符号 & 意义 & 数值 \\
  \hline
  $\hbar$ & 约化Planck常数 & $1.055 \times 10^{-34}~\mathrm{J\,s}$ \\
  $c$ & 光速 & $3\times10^8~\mathrm{m/s}$ \\
  $k_B$ & Boltzmann常数 & $1.381 \times 10^{-23}~\mathrm{J/K}$ \\
  $e$ & 元电荷 & $1.602 \times 10^{-19}~\mathrm{C}$ \\
  $\epsilon_0$ & 真空介电常数 & $8.854 \times 10^{-12}~\mathrm{F/m}$ \\
  $\mu_0$ & 真空磁导率 & $4\pi \times 10^{-7}~\mathrm{N/A^2}$\\
  $\alpha$ & 精细结构常数 & $\approx 1/137$\\
  $\Lambda_{\text{QCD}}$ & QCD标度参数 & $\approx 200~\mathrm{MeV}$\\
  $G_F$ & Fermi耦合常数 & $1.166 \times 10^{-5}~\mathrm{GeV}^{-2}$\\
  $M_W$ & W玻色子质量 & $80.379~\mathrm{GeV/c^2}$\\
  $M_Z$ & Z玻色子质量 & $91.1876~\mathrm{GeV/c^2}$\\
  $M_H$ & Higgs玻色子质量 & $125.1~\mathrm{GeV/c^2}$\\
  \hline
\end{tabular}
\caption{国际单位制中的一些重要物理常数}
\label{tab:physical_constants}
\end{table}
这些单位自然是正确的, 但是对于基本的单位检查, 我们考虑如下基本单位, 米, 秒, 千克, 库仑, 焦耳, 开尔文:
\begin{equation}
  \mathrm{m} \quad \mathrm{s} \quad \mathrm{Kg} \quad \mathrm{C} \quad \mathrm{J}  \quad \mathrm{K}
\end{equation}
其中焦耳是导出单位, 安培也是导出单位, 法拉第Farad(电容的单位), 牛, 也是导出单位:
\begin{equation}
  \mathrm{J} = \frac{\mathrm{Kg} \cdot \mathrm{m^2}}{\mathrm{s^{-2}}} \quad \mathrm{A} = \frac{\mathrm{C}}{\mathrm{s}} \quad \mathrm{F} = \frac{\mathrm{C}}{\mathrm{V}} = \frac{\mathrm{C}^2}{\mathrm{J}} \quad \mathrm{N} = \frac{\mathrm{J}}{\mathrm{m}}
\end{equation}
从而我们立刻可以写出一些其他的导出单位, 比如伏特Volt, 电场强度, 磁场强度等:
\begin{equation}
  \mathrm{V} = \frac{\mathrm{J}}{\mathrm{C}} \quad \mathrm{V/m} = \frac{\mathrm{J}}{\mathrm{C} \cdot \mathrm{m^{-1}}} \quad \mathrm{T} = \frac{\mathrm{J} \cdot \mathrm{s}}{\mathrm{C} \cdot \mathrm{m^2}}
\end{equation}
对于数值上的选择, 焦耳对于微观系统太大了, 所以我们主要使用电子伏特eV作为基本单位, 就是一个电子在1伏特的电压下获得的能量:
\begin{equation}
  1~\mathrm{eV} = 1.602 \times 10^{-19}~\mathrm{J}
\end{equation}
然后我们有不同标度上的单位, 比如MeV, GeV, TeV, PeV, EeV, ZeV, HeV等:
\begin{equation}
  1~\mathrm{MeV} = 10^6~\mathrm{eV} \quad 1~\mathrm{GeV} = 10^9~\mathrm{eV} \quad 1~\mathrm{TeV} = 10^{12}~\mathrm{eV}
\end{equation}
如果是凝聚态系统, 我们可能更多考虑的是meV, $\mu$eV, neV等:
\begin{equation}
  1~\mathrm{meV} = 10^{-3}~\mathrm{eV} \quad 1~\mu\mathrm{eV} = 10^{-6}~\mathrm{eV} \quad 1~\mathrm{neV} = 10^{-9}~\mathrm{eV}
\end{equation}
同理, 对于时间, 我们使用秒作为基本单位, 但是对于微观系统, 我们使用皮秒ps, 飞秒fs, 阿秒as, 纳秒ns等:
\begin{equation}
  1~\mathrm{ps} = 10^{-12}~\mathrm{s} \quad 1~\mathrm{fs} = 10^{-15}~\mathrm{s} \quad 1~\mathrm{as} = 10^{-18}~\mathrm{s}
\end{equation}
对于长度, 我们使用米作为基本单位, 但是对于微观系统, 我们使用纳米nm, 微米$\mu$m, 皮米pm等:
\begin{equation}
  1~\mathrm{nm} = 10^{-9}~\mathrm{m} \quad 1~\mu\mathrm{m} = 10^{-6}~\mathrm{m} \quad 1~\mathrm{pm} = 10^{-12}~\mathrm{m}
\end{equation}


现在我们引入自然单位制, 优点有两个, 第一个我们不用再写$\hbar$, $c$这些常数了, 第二个就是我们在进行量纲分析的时候, 只需要考虑能量的单位或者质量的单位, 其他的单位都可以通过能量或者质量来转换.
在自然单位制下, 我们有:
\begin{equation}
  \hbar = c = 1
\end{equation}
为了处理电磁学问题, 我们还要考虑Heaviside-Lorentz单位制, 也就是 (根据电磁学, $c^2 \epsilon_0 \mu_0 = 1$):
\begin{equation}
  \epsilon_0 = \mu_0 = 1
\end{equation}
为了处理热力学问题, 我们还引入:
\begin{equation}
  k_B = 1
\end{equation}
根据国际单位制中最基本的关系, 我们可考虑能量-时间, 能量-长度, 质量-长度等关系:
\begin{equation}
  E = \hbar \omega  \quad E = m c^2 = m \quad L=c t
\end{equation}
转化到自然单位制下, 我们立刻发现:
\begin{enumerate}
\item 质量的单位和能量的单位是相同的, 都是$\mathrm{eV}$.
\item 时间的单位是能量的倒数, 也就是$\mathrm{eV}^{-1}$.
\item 长度的单位是能量的倒数, 也就是$\mathrm{eV}^{-1}$.
\end{enumerate}
一个基本原理不能被混淆: \fr{无量纲的数在任何单位制下都是无量纲的, 选择单位制只是为了方便计算和表达, 物理量的本质不变}.
当然我们国际单位制下的量和在自然单位制下的量数值是不相同的.
我们再表格Table.~\ref{tab:natural_units_physical_constants}中列出一些重要的物理常数在自然单位制下的数值.
\begin{table}[h!]
\centering
\begin{tabular}{|l|l|}
  \hline
  SI数值 & 自然单位制数值 \\
  \hline
  1~$\mathrm{J}$ & $6.242 \times 10^{18}~\mathrm{eV}$ \\
  1~$\mathrm{s}$ & $1.52 \times 10^{15}~\mathrm{eV}^{-1}$ \\
  1~$\mathrm{m}$ & $5.07 \times 10^{6}~\mathrm{eV}^{-1}$ \\
  1~$\mathrm{kg}$ & $5.61 \times 10^{35}~\mathrm{eV}$ \\
  $e$ & $0.303$ \\
  1~$\mathrm{K}$ & $8.617 \times 10^{-5}~\mathrm{eV}$ \\
  \hline
\end{tabular}
\caption{自然单位制中的一些重要物理常数}
\label{tab:natural_units_physical_constants}
\end{table}
其中, $e$ 是元电荷的无量纲化数值, 是根据精细结构常数$\alpha$:
\begin{equation}
  \alpha = \frac{e^2}{4\pi\epsilon_0 \hbar c} \approx \frac{1}{137}
\end{equation}
换算出来的:
\begin{equation}
  e = \sqrt{4\pi\alpha} \approx 0.303
\end{equation}

%====================
%====================
\newpage
\section{电动力学}
\label{CH1 S4 Electrodynamics}
%====================
%====================

%====================
%====================
\section{狭义相对论}
\label{CH1 S2 Special relativity}
%====================
%====================

%====================
%====================
\newpage
\section{量子力学}
\label{CH1 S3 Quantum mechanics}
%====================
%====================
% 概率密度, 概率流
% Heisenberg方法
% 薛定谔方程, 时间演化算符
% 全同粒子假设
% Fock空间
% 相对论量子力学
初期对于量子力学的讨论, 主要是对于经典力学理论的量子化, 也就是将经典力学的物理量变成动力学量, observables, 然后我们可以通过测量来获得物理量的数值:
\begin{equation}
  \expval{\mathcal{O}} = \mel**{\psi}{\mathcal{O}}{\psi}
\end{equation}
当然你可以选择把上面的式子投影到位置空间计算:
\begin{equation}
  \expval{\mathcal{O}} = \int_{\mathbb{R}^3} \psi^*(\bm{x}') \mel**{\bm{x}'}{\mathcal{O}}{\bm{x}} \psi(\bm{x}) \dd[3]{x} 
\end{equation}
这样就变成了求力学量的矩阵元问题.
在这个问题中, 我们没有考虑任何时间的问题.
我们在量子力学中接触的最多的就是Schrödinger方程, 他的核心在于, 算符不随时间演化, 但是态是随时间演化的.
态的演化由如下Schrödinger方程解出:
\begin{equation}
  \mathrm{i}\, \hbar \pdv{\ket{\psi;t}}{t} = \hat{H} \ket{\psi;t}
\end{equation}
其中$\hat{H}$是Hamilton算符, $\ket{\psi;t}$是态的时间演化.
这牵扯出来了第一个问题, 我们怎么写出来Hamiltonian算符呢?
Hamiltonian算符的写法是基于经典力学的, 我们先不说算符层面的, 我们先说经典力学的Hamiltonian, 他由Legendre方程导出, 也就是:
\begin{equation}
  H(q, p) = \sum_i p_i \dot{q}_i - L(q, \dot{q})
\end{equation}
其中$q_i$是广义坐标, $\dot{q}_i$是广义速度, $p_i$是广义动量, $L(q, \dot{q})$是Lagrangian.
广义动量是由Lagrangian导出的:
\begin{equation}
  p_i = \pdv{L}{\dot{q}_i}
\end{equation}
实际上他的正确名字是正则共轭动量, canonical conjugate momentum.
我们要注意, 正则动量和机械动量是不同的, 机械动量是一个例子的真正运动速度给出的:
\begin{equation}
  \bm{p} = m \bm{v}
\end{equation}
很多时候他们是重合的, 但是在有外场作用的情况下, 他们是不同的.
现在我们有了经典力学的Hamiltonian, 我们可以将他量子化, 也就是将广义坐标和广义动量变成算符:
\begin{equation}
  \hat{H} = \sum_i \hat{p}_i \hat{\dot{q}}_i - \hat{L}(\hat{q}, \hat{\dot{q}})
\end{equation}
也就是说, 我们规则化的把位置提升到位置算符, 动量提升到动量算符.
算符就是一个线性映射, 他将态空间中的态映射到另一个态空间中.
而算符一般又不是阿贝尔 (abelian) 的, 也就是算符之间不满足交换律:
\begin{equation}
  \hat{A} \hat{B} \neq \hat{B} \hat{A}
\end{equation}
这就导致了一个问题, 我们怎么定义算符的乘积呢?
这是一个规则问题, 我们考虑Weyl序方法:
\begin{definition}[][Weyl序]
  Weyl序是将两个算符的乘积写成算符的平均值, 也就是:
  \begin{equation}
    \hat{A} \hat{B} = \frac{1}{2} (\hat{A} \hat{B} + \hat{B} \hat{A})
  \end{equation}
  这个方法可以推广到对于多次单项式算符的乘积, 也就是:
  \begin{equation}
    \hat{A}^m \hat{A}^n \to \sum_{\sigma \in S_{n+m}} \frac{m! n!}{(m+n)!} \hat{\mathcal{O}}_1 \hat{\mathcal{O}}_2 \cdots \hat{\mathcal{O}}_{m+n}
  \end{equation}
  其中$S_{n+m}$是$n+m$个算符的所有排列, $\sigma$是其中的一种排列, 所以就是对所有排列求和.
  $\hat{\mathcal{O}}_1$是在排列$\sigma$下的第一个算符, $\hat{\mathcal{O}}_2$是第二个算符, 以此类推.
\end{definition}
我们举几个例子, 考虑经典的力学量是$xp$, 那么在Weyl序下, 我们有量子化的结果:
\begin{equation}
  xp \to \frac{1}{2} (\hat{x} \hat{p} + \hat{p} \hat{x})
\end{equation}
对于二次的力学量, 比如$xp^2$, 我们有:
\begin{equation}
  xp^2 \to \frac{1}{3} (\hat{x} \hat{p}^2 + \hat{p}^2 \hat{x} + 2 \hat{p} \hat{x} \hat{p})
\end{equation}
对于三次的力学量, 比如$x^2 p^3$, 我们有:
\begin{equation}
  x^2 p^3 \to \frac{1}{4} (\hat{x}^2 \hat{p}^3 + \hat{p}^3 \hat{x}^2 + 3 \hat{x} \hat{p}^2 \hat{x} + 3 \hat{p} \hat{x}^2 \hat{p})
\end{equation}
我们一般也不会遇到太多次数的力学量, 所以不做过多示范了.
Weyl序有一个特别优势:
\begin{theorem}[][Weyl序的优势]
  Weyl序的量子化方法是经典到量子对应中, 唯一能把实值符号映射为自伴算符的对称规则.
\end{theorem}
所以只要我们的经典力学量是实值的, 那么Weyl序就能给出一个自伴算符, 也就是Hermitian算符.
一个很实用的例子就是考虑角动量算符, 在经典力学中
\begin{equation}
  L_z = (\bm{x} \times \bm{p} )_z = x p_y - y p_x
\end{equation}
考虑Weyl序:
\begin{equation}
  x p_y \to \frac{1}{2} (\hat{x} \hat{p}_y + \hat{p}_y \hat{x}) \quad y p_x \to \frac{1}{2} (\hat{y} \hat{p}_x + \hat{p}_x \hat{y})
\end{equation}
所以我们有:
\begin{equation}
  \hat{L}_z = \frac{1}{2} (\hat{x} \hat{p}_y + \hat{p}_y \hat{x}) - \frac{1}{2} (\hat{y} \hat{p}_x + \hat{p}_x \hat{y})
\end{equation}
如果不考虑外场, 我们有$[\hat{x}, \hat{p}_y] = 0$,  $[\hat{y}, \hat{p}_x] = 0$, 我们当然就获得了教科书里的标准形式:
\begin{equation}
  \hat{L}_z = \hat{x} \hat{p}_y - \hat{y} \hat{p}_x
\end{equation}


现在我们回到Schrödinger方程的讨论, 我们现在就能系统的写出来Hamiltonian算符了, 也就是:
\begin{equation}
  \hat{H} = \frac{\hat{\bm{p}}^2}{2m} + V(\hat{\bm{x}})
\end{equation}
其中$\hat{\bm{p}}$是动量算符, $\hat{\bm{x}}$是位置算符, $V(\hat{\bm{x}})$是势能算符.
对于Schrödinger方程, 我们有:
\begin{equation}
  \mathrm{i}\, \hbar \pdv{\ket{\psi;t}}{t} = \frac{\hat{\bm{p}}^2}{2m} \ket{\psi;t} + V(\hat{\bm{x}}) \ket{\psi;t}
\end{equation}
我们可以将态写成位置空间的波函数:
\begin{equation}
  \psi(\bm{x}; t) = \braket{\bm{x}}{\psi;t}
\end{equation}
然后我们可以将Schrödinger方程写成波函数的形式:
\begin{equation}
  \mathrm{i}\, \hbar \pdv{\psi(\bm{x}; t)}{t} = \left(\frac{\hat{p}^2}{2m} + V(\hat{\bm{x}}) \right) \psi(\bm{x}; t)
\end{equation}
这就是我们在量子力学课程中解决的东西.
虽然他是一个线性方程, 就是两个解的线性组合$\psi_1 + \psi_2$仍然是解.
但是求解这个方程可不简单, 尤其是势能$V(\hat{\bm{x}})$很复杂的时候, 这个在量子力学课程中已经有所涉及.
所以我们一般考虑扰动方法求解, 不管是含时的还是不含时的.
从流体力学的角度来看, 我们有一个起点, 就是发现粒子的概率在整个空间中是$1$:
\begin{equation}
  \int_{\mathbb{R}^3} \abs{\psi(\bm{x}; t)}^2 \dd[3]{x} = 1
\end{equation}
我们补充一点流体力学的概念.
在流体力学中, 我们不关心单个粒子的运动, 而是关心流体的整体运动, 所以我们考虑流体的密度, 流体的速度, 流体的压力等.
我们首先圈定一块儿控制体积, control volume, 然后我们考虑流体在这个控制体积内的运动, 注意, 控制体积是不随着时间变化的.
当然是可以有流体从控制体积内流出, 也可以有流体从控制体积外流入.
最重要的两个概念就是流体的密度和流体的速度, 我们用$\rho$表示流体的密度, $\bm{v}$表示流体的速度.
我们只考虑最简单的一种流体力学, 就是粒子流, 如果是考虑电流, 就是每个电荷的流动, 如果是热力学流, 就是每个粒子带着热量的流动.


如果我们考虑一个控制体积区域$V$, 他的边界记作$\partial V$ (边界是一个曲面, 如果是二维自然就是一条曲线了).
我们定义曲面上的法向量为$\hat{n}(\bm{x})$, 其中$\bm{x} \in \partial S$.
我们从质量的定义出发, 在时刻$t$, 我们有:
\begin{equation}
  M(t) = \int_V \rho(\bm{x}, t) \dd[3]{x}
\end{equation}
控制体积内如果没有源, 那么质量是守恒的.
\begin{remark}
  一个生活化的例子, 就是考虑一个水池, 如果水池里面没有水流入或者流出, 那么水池内的水量是守恒的.
  当然了, 没有源的意思就是泳池里面没有水龙头.
\end{remark} 
所以控制体积中的质量守恒方程立刻翻译成, 任何质量的变化一定伴随着边界上流体的出入:
\begin{equation}
  \dv{M(t)}{t} + \int_{\partial V} \rho(\bm{x}, t) \bm{v}(\bm{x}, t) \cdot \hat{n}(\bm{x}) \dd{S} = 0
\end{equation}
第一项:
\begin{equation}
  \dv{M(t)}{t} = \int_V \pdv{\rho(\bm{x}, t)}{t} \dd[3]{x}
\end{equation}
第二项:
\begin{equation}
  \int_{\partial V} \rho(\bm{x}, t) \bm{v}(\bm{x}, t) \cdot \hat{n}(\bm{x}) \dd{S} = \int_V \nabla \cdot (\rho(\bm{x}, t) \bm{v}(\bm{x}, t)) \dd[3]{x}
\end{equation}
所以我们有:
\begin{equation}
  \int_V \left( \pdv{\rho(\bm{x}, t)}{t} + \nabla \cdot (\rho(\bm{x}, t) \bm{v}(\bm{x}, t)) \right) \dd[3]{x} = 0
\end{equation}
由于这个方程对于任意的控制体积$V$都成立, 所以
\begin{equation}
  \pdv{\rho(\bm{x}, t)}{t} + \nabla \cdot (\rho(\bm{x}, t) \bm{v}(\bm{x}, t)) = 0
\end{equation}
这个方程就是流体力学中的连续性方程, continuity equation.
我们根据
\begin{equation}
  \dv{M(t)}{t} + \int_{\partial V} \rho(\bm{x}, t) \bm{v}(\bm{x}, t) \cdot \hat{n}(\bm{x}) \dd{S} = 0
\end{equation}
也可以定义质量流的概念: 粒子在单位时间内穿过指定曲面的总量.
\begin{equation}
  J = \int_{\partial V} \rho(\bm{x}, t) \bm{v}(\bm{x}, t) \cdot \hat{n}(\bm{x}) \dd{S} \quad \frac{\text{Kg}}{\text{s}}
\end{equation}
如果我们想定义每秒钟有多少千克的流体穿过单位面积, 那么我们可以定义质量流密度:
\begin{equation}
  \bm{j} = \rho(\bm{x}, t) \bm{v}(\bm{x}, t) \quad \frac{\text{Kg}}{\text{m}^2 \cdot \text{s}}
\end{equation}
这个就是流体力学中的质量流密度, mass flux density.
从而我们的连续性方程被改写为:
\begin{equation}
  \pdv{\rho(\bm{x}, t)}{t} + \nabla \cdot \bm{j} = 0
\end{equation}

在量子力学中, 我们有类似的概念, 我们考虑粒子的概率密度, 也就是:
\begin{equation}
  \rho(\bm{x}, t) = \abs{\psi(\bm{x}, t)}^2
\end{equation}
我们可以计算一下概率密度随着时间的导数:
\begin{equation}
  \pdv{\rho(\bm{x}, t)}{t} = \pdv{}{t} \abs{\psi(\bm{x}, t)}^2 = \psi^*(\bm{x}, t) \pdv{\psi(\bm{x}, t)}{t} + \psi(\bm{x}, t) \pdv{\psi^*(\bm{x}, t)}{t}
\end{equation}
考虑含时的Schrödinger方程:
\begin{equation}
  \mathrm{i}\, \hbar \pdv{\psi(\bm{x}, t)}{t} = \left( -\frac{\hbar^2}{2m} \nabla^2 + V(\bm{x}) \right) \psi(\bm{x}, t)
\end{equation}
我们可以将他写成:
\begin{equation}
  \pdv{\psi(\bm{x}, t)}{t} = \frac{\mathrm{i}\, \hbar}{2m} \nabla^2 \psi(\bm{x}, t) + \frac{1}{\mathrm{i}\, \hbar} V(\bm{x}) \psi(\bm{x}, t)
\end{equation}
然后我们考虑他的共轭方程:
\begin{equation}
  \pdv{\psi^*(\bm{x}, t)}{t} = -\frac{\mathrm{i}\, \hbar}{2m} \nabla^2 \psi^*(\bm{x}, t) - \frac{1}{\mathrm{i}\, \hbar} V(\bm{x}) \psi^*(\bm{x}, t)
\end{equation}
将这两个方程代入到概率密度的时间导数中:
\begin{align}
  \pdv{\rho(\bm{x}, t)}{t} =& \psi^*(\bm{x}, t) \left( \frac{\mathrm{i}\, \hbar}{2m} \nabla^2 \psi(\bm{x}, t) + \frac{1}{\mathrm{i}\, \hbar} V(\bm{x}) \psi(\bm{x}, t) \right) \\
  &+ \psi(\bm{x}, t) \left( -\frac{\mathrm{i}\, \hbar}{2m} \nabla^2 \psi^*(\bm{x}, t) - \frac{1}{\mathrm{i}\, \hbar} V(\bm{x}) \psi^*(\bm{x}, t) \right) \\
  =& \frac{\mathrm{i}\, \hbar}{2m} \left( \psi^*(\bm{x}, t) \nabla^2 \psi(\bm{x}, t) - \psi(\bm{x}, t) \nabla^2 \psi^*(\bm{x}, t) \right) \\
  &+ \frac{1}{\mathrm{i}\, \hbar} V(\bm{x}) \left( \psi^*(\bm{x}, t) \psi(\bm{x}, t) - \psi(\bm{x}, t) \psi^*(\bm{x}, t) \right) \\
  =& \frac{\mathrm{i}\, \hbar}{2m} \left( \psi^*(\bm{x}, t) \nabla^2 \psi(\bm{x}, t) - \psi(\bm{x}, t) \nabla^2 \psi^*(\bm{x}, t) \right)
\end{align}
我们可以将这个方程写成:
\begin{equation}
  \pdv{\rho(\bm{x}, t)}{t} = \frac{\mathrm{i}\, \hbar}{2m} \nabla \cdot \left( \psi^*(\bm{x}, t) \nabla \psi(\bm{x}, t) - \psi(\bm{x}, t) \nabla \psi^*(\bm{x}, t) \right)
\end{equation}
我们可以定义一个概率流, probability flux, 也就是:
\begin{equation}
  \bm{j}(\bm{x}, t) = -\frac{\mathrm{i}\, \hbar}{2m} \left( \psi^*(\bm{x}, t) \nabla \psi(\bm{x}, t) - \psi(\bm{x}, t) \nabla \psi^*(\bm{x}, t) \right)
\end{equation}
这样我们之前的式子化简为:
\begin{equation}
  \pdv{\rho(\bm{x}, t)}{t} + \nabla \cdot \bm{j}(\bm{x}, t) = 0
\end{equation}
这个方程就是量子力学中的连续性方程, 也就是概率守恒方程.
\fr{实际上, 我们完全可以根据流体力学对于$bm{j}$的定义, 以及Weyl序来获得一样的结果}.


我们这里为了理论的完整性, 只是形式上的给出级数解, 方法是考虑时间演化算符:
\begin{equation}
  \ket{\psi;t} = \hat{U}(t,t_0) \ket{\psi;t_0}
\end{equation}
从而我们的Schrödinger方程变成了:
\begin{equation}
  \mathrm{i}\, \hbar \pdv{}{t}\hat{U}(t,t_0)\ket{\psi;t_0} = \hat{H} \hat{U}(t,t_0) \ket{\psi;t_0}
\end{equation}
这个方程自然是不依赖于$t_0$的, 所以我们得到了时间演化算符的方程:
\begin{equation}
  \mathrm{i}\, \hbar \pdv{\hat{U}(t,t_0)}{t} = \hat{H} \hat{U}(t,t_0)
\end{equation}
我们考虑一般的情况, 就是$\hat{H}$是时间相关的, 也就是$\hat{H} = \hat{H}(t)$, 那么我们可以将时间演化算符写成如下的形式:
\begin{equation}
  \hat{U}(t,t_0) = \mathbb{I} + \frac{1}{\mathrm{i}\, \hbar} \int_{t_0}^{t} \hat{H}(t_1) \hat{U}(t_1,t_0) \dd{t_1}
\end{equation}
我们考虑使用Picard迭代方法, 我们先不考虑积分右侧, 那自然就是迭代的第0阶:
\begin{equation}
  \hat{U}^{(0)}(t,t_0) = \mathbb{I}
\end{equation}
然后迭代第1阶, 我们有:
\begin{equation}
  \hat{U}^{(1)}(t,t_0) = \mathbb{I} + \frac{1}{\mathrm{i}\, \hbar} \int_{t_0}^{t} \hat{H}(t_1) \dd{t_1}
\end{equation}
然后迭代第2阶, 我们有:
\begin{align}
  \hat{U}^{(2)}(t,t_0) =& \mathbb{I} + \frac{1}{\mathrm{i}\, \hbar} \int_{t_0}^{t} \hat{H}(t_1) \hat{U}^{(1)}(t_1,t_0) \dd{t_1} \\
  =& \mathbb{I} + \frac{1}{\mathrm{i}\, \hbar} \int_{t_0}^{t} \hat{H}(t_1) \left( \mathbb{I} + \frac{1}{\mathrm{i}\, \hbar} \int_{t_0}^{t_1} \hat{H}(t_2) \dd{t_2} \right) \dd{t_1} \\
  =& \mathbb{I} + \frac{1}{\mathrm{i}\, \hbar} \int_{t_0}^{t} \hat{H}(t_1) \dd{t_1} + \frac{1}{(\mathrm{i}\, \hbar)^2} \int_{t_0}^{t} \int_{t_0}^{t_1} \hat{H}(t_1) \hat{H}(t_2) \dd{t_2} \dd{t_1}
\end{align}
然后我们形式上可以写出无限迭代后的解:
\begin{equation}
  \hat{U}^{(n)}(t,t_0) = \mathbb{I} + \sum_{k=1}^{n} \frac{1}{(\mathrm{i}\, \hbar)^k} \int_{t_0}^{t} \int_{t_0}^{t_1} \cdots \int_{t_0}^{t_{k-1}} \hat{H}(t_1) \hat{H}(t_2) \cdots \hat{H}(t_k) \dd{t_k} \dd{t_{k-1}} \cdots \dd{t_1}
\end{equation}
这个就是Dyson级数, 我们可以借用时间排序算符, 把他写成更紧凑的形式.
时间排序算符定义如下:
\begin{definition}[][时间排序算符]
  时间排序算符是一个算符, 他将一系列算符按照时间从大到小的顺序排列, 也就是:
  \begin{equation}
    \mathcal{T} \left( \hat{A}(t_1) \hat{A}(t_2) \cdots \hat{A}(t_n) \right) = \hat{A}(t_{\sigma(1)}) \hat{A}(t_{\sigma(2)}) \cdots \hat{A}(t_{\sigma(n)})
  \end{equation}
  其中$\sigma$是一个排列, 满足$t_{\sigma(1)} > t_{\sigma(2)} > \cdots > t_{\sigma(n)}$.
\end{definition}
如果我们考虑指数函数的展开:
\begin{equation}
  e^{\hat{A}} = \mathbb{I} + \hat{A} + \frac{1}{2!} \hat{A}^2 + \frac{1}{3!} \hat{A}^3 + \cdots
\end{equation}
然后我们考虑:
\begin{equation}
  \exp(\frac{1}{\mathrm{i}\,\hbar} \int_{t_0}^{t} \hat{H}(t') \dd{t'}) = \mathbb{I} + \frac{1}{\mathrm{i}\,\hbar} \int_{t_0}^{t} \hat{H}(t') \dd{t'} + \frac{1}{2! (\mathrm{i}\,\hbar)^2} \int_{t_0}^{t} \int_{t_0}^{t'} \hat{H}(t') \hat{H}(t'') \dd{t''} \dd{t'} + \cdots
\end{equation}
我们把时间轴从过去到未来排列好, 自然就是:
\begin{equation}
  \mathcal{T} \exp(\frac{1}{\mathrm{i}\,\hbar} \int_{t_0}^{t} \hat{H}(t') \dd{t'}) = \mathbb{I} + \frac{1}{\mathrm{i}\,\hbar} \int_{t_0}^{t} \hat{H}(t_1) \dd{t_1} + \frac{1}{2! (\mathrm{i}\,\hbar)^2} \int_{t_0}^{t} \int_{t_0}^{t_1} \hat{H}(t_1) \hat{H}(t_2) \dd{t_2} \dd{t_1} + \cdots
\end{equation}
从而我们可以将Dyson级数写成如下的形式:
\begin{equation}
  \hat{U}(t,t_0) = \mathcal{T} \exp\left( -\frac{\mathrm{i}}{\hbar} \int_{t_0}^{t} \hat{H}(t') \dd{t'} \right)
\end{equation}
当然只有这个式子是没有什么实际计算意义上的, 因为Dyson级数的的计算是很复杂的, 但至少有了形式上的迭代解.


当然, 我们也可以不使用态的演化来描述量子力学, 我们可以使用算符的演化来描述量子力学, 从而确保态是不变的.
我们从Schrödinger绘景出发, 我们考虑一个和时间无关的算符$\hat{A}$.
再$t$时刻, 我们求这个算符的在态$\ket{\Psi;t}$的期望值, 也就是:
\begin{equation}
  \expval{\hat{A}} = \mel**{\Psi;t}{\hat{A}}{\Psi;t}
\end{equation}
其中态的演化由时间演化算符给出, 是Hamiltonian算符决定的:
\begin{equation}
  \ket{\Psi;t} = \hat{U}(t,t_0) \ket{\Psi;t_0} \quad \hat{U}(t,t_0) = \mathcal{T} \exp\left( -\frac{\mathrm{i}}{\hbar} \int_{t_0}^{t} \hat{H}(t') \dd{t'} \right)
\end{equation}
我们对$\expval{\hat{A}} = \mel**{\Psi;t}{\hat{A}}{\Psi;t}$这个式子进行一下变形:
\begin{equation}
  \expval{\hat{A}} = \mel**{\Psi;t_0}{\hat{U}^\dagger(t,t_0) \hat{A} \hat{U}(t,t_0)}{\Psi;t_0}
\end{equation}
其中$\hat{U}(t,t_0)$是时间演化算符, $\hat{U}^\dagger(t,t_0)$是他的厄米共轭, $t_0$是$t$之前的一个时刻.
也就是说, 我们在$t$时刻的期望值, 不仅可以考虑一个不随时间移动的算符, 在$t$时刻的态来计算, 还可以\fr{考虑一个固定时刻的态, 然后把算符演化到$t$时刻来计算}.


这就是Heisenberg方法, 他是将态空间的态固定, 而算符随着时间演化.
\begin{definition}[][Heisenberg方法]
  Heisenberg绘景中的算符是随着时间演化的, 也就是:
  \begin{equation}
    \hat{A}_{\text{H}}(t) = \hat{U}(t,t_0) \hat{A}_{\text{S}}(t_0) \hat{U}^\dagger(t,t_0)
  \end{equation}
  其中$\hat{U}(t,t_0)$是时间演化算符, $\hat{A}_{\text{S}}(t_0)$是初始时刻的算符.
  态是不随时间演化的, 就一直是$\ket{\psi;t_0}$.
\end{definition}
\fr{这并不是否定Schorödinger绘景下的算符可以带时间}, 因为有的算符就是随时间变化的.
Heisenbg绘景的变化方法还是适用的:
\begin{equation}
  \hat{A}_{\text{H}}(t) = \hat{U}(t,t_0) \hat{A}_{\text{S}}(t) \hat{U}^\dagger(t,t_0)
\end{equation}
这个里面的$t_0$就告诉了我们, 我们选择了$t_0$时刻的Schrödinger绘景下的态作为我们Heisenberg绘景下不再随着时间变化的态.

当然了, 态不随着时间的演化了, 算符就要随着时间演化了:
\begin{theorem}[][Heisenberg运动方程]
  在Heisenberg绘景下, 算符的时间演化满足如下方程:
  \begin{equation}
    \mathrm{i}\, \hbar \pdv{\hat{A}_{\text{H}}(t)}{t} = [\hat{A}_{\text{H}}(t), \hat{H}_{\text{H}}(t)] + \mathrm{i}\,\hbar \hat{U}^\dagger(t,t_0) \pdv{\hat{A}_{\text{S}}(t)}{t} \hat{U}(t,t_0)
  \end{equation}
  其中$\hat{H}_{\text{H}}(t)$是Hamiltonian算符在Heisenberg绘景下的形式, $\hat{A}_{\text{S}}(t)$是Schrödinger绘景下的算符.
\end{theorem}
\begin{proof}
  我们考虑Heisenberg绘景下的算符$\hat{A}_{\text{H}}(t)$, 他是由Schrödinger绘景下的算符$\hat{A}_{\text{S}}(t)$通过时间演化算符$\hat{U}(t,t_0)$得到的:
  \begin{equation}
    \hat{A}_{\text{H}}(t) = \hat{U}(t,t_0) \hat{A}_{\text{S}}(t) \hat{U}^\dagger(t,t_0)
  \end{equation}
  我们对这个式子求导, 得到:
  \begin{align}
    \pdv{\hat{A}_{\text{H}}(t)}{t} &= \pdv{\hat{U}(t,t_0)}{t} \hat{A}_{\text{S}}(t) \hat{U}^\dagger(t,t_0) + \hat{U}(t,t_0) \pdv{\hat{A}_{\text{S}}(t)}{t} \hat{U}^\dagger(t,t_0) + \hat{U}(t,t_0) \hat{A}_{\text{S}}(t) \pdv{\hat{U}^\dagger(t,t_0)}{t} \\
    &= -\frac{\mathrm{i}}{\hbar} \hat{H}_{\text{H}}(t) \hat{A}_{\text{H}}(t) + \frac{\mathrm{i}}{\hbar} \hat{A}_{\text{H}}(t) \hat{H}_{\text{H}}(t) + \hat{U}^\dagger(t,t_0) \pdv{\hat{A}_{\text{S}}(t)}{t} \hat{U}(t,t_0)
  \end{align}
  其中我们使用了Hamiltonian算符在Heisenberg绘景下的形式:
  \begin{equation}
    \hat{H}_{\text{H}}(t) = \hat{U}(t,t_0) \hat{H}_{\text{S}}(t) \hat{U}^\dagger(t,t_0)
  \end{equation}
  以及时间演化算符的定义:
  \begin{equation}
    \hat{U}(t,t_0) = \mathcal{T} \exp\left( -\frac{\mathrm{i}}{\hbar} \int_{t_0}^{t} \hat{H}_{\text{S}}(t') \dd{t'} \right)
  \end{equation}
  将上面的式子整理一下, 我们就得到了Heisenberg运动方程:
  \begin{equation}
    \mathrm{i}\, \hbar \pdv{\hat{A}_{\text{H}}(t)}{t} = [\hat{A}_{\text{H}}(t), \hat{H}_{\text{H}}(t)] + \mathrm{i}\,\hbar \hat{U}^\dagger(t,t_0) \pdv{\hat{A}_{\text{S}}(t)}{t} \hat{U}(t,t_0)
  \end{equation}
  这个方程告诉我们, 在Heisenberg绘景下, 算符的时间演化是由Hamiltonian算符和Schrödinger绘景下的算符的时间导数共同决定的.
\end{proof}


我们现在考虑一个超简单例子, 比如我们考虑一个不随时间变化的算符$\hat{x}_{\text{S}}$, 然后我们的Hamiltonian是一个自由粒子Hamiltonian, 也就是:
\begin{equation}
  \hat{H}_{\text{S}} = \frac{\hat{p}^2_{\text{S}}}{2m}
\end{equation}
那么我们有:
\begin{equation}
  \mathrm{i}\, \hbar \pdv{\hat{x}_{\text{H}}(t)}{t} = [\hat{x}_{\text{H}}(t), \hat{H}_{\text{H}}(t)]
\end{equation}
我们现在需要计算如下的对易:
\begin{equation}
  [\hat{x}_{\text{H}}(t), \hat{H}_{\text{H}}(t)] = \left[\hat{U}(t,t_0) \hat{x}_{\text{S}}(t) \hat{U}^\dagger(t,t_0), \frac{\hat{p}^2}{2m}\right] = \frac{1}{2m} \left[\hat{U}(t,t_0) \hat{x}_{\text{S}}(t) \hat{U}^\dagger(t,t_0), \hat{p}^2\right]
\end{equation}
因为$\hat{U}(t,t_0)$和$\hat{U}^\dagger(t,t_0)$是时间演化算符, 而且他们的指数内只包含动能项, 所以他和动量算符$\hat{p}$是对易的, 也就是:
\begin{equation}
  \left[\hat{U}(t,t_0) \hat{x}_{\text{S}}(t) \hat{U}^\dagger(t,t_0), \hat{p}^2\right] = \left[ \hat{U}(t,t_0) (\hat{x}_{\text{S}} \hat{p}^2 - \hat{p}^2 \hat{x}_{\text{S}}) \hat{U}^\dagger(t,t_0) \right]
\end{equation}
利用基本对易关系:
\begin{equation}
  [\hat{x}, \hat{p}] = \mathrm{i}\, \hbar
\end{equation}
我们获得:
\begin{equation}
  \mathrm{i}\, \hbar \pdv{\hat{x}_{\text{H}}(t)}{t} = \frac{2 \mathrm{i}\, \hbar}{2m} \hat{p}_{\text{H}}(t)
\end{equation}
这还是一个微分方程, 我们如果考虑从$t_0$到$t$的演化, 那么我们可以将他积分:
\begin{equation}
  \hat{x}_{\text{H}}(t) - \hat{x}_{\text{H}}(t_0) = \frac{1}{m} \int_{t_0}^{t} \hat{p}_{\text{H}}(t') \dd{t'}
\end{equation}
这里有出现一个问题, 我们还没说$\hat{p}_{\text{H}}(t)$的演化方程, 但是我们可以使用Heisenberg运动方程来求解他, 而且很简单, 因为对易, 我们直接有:
\begin{equation}
  \mathrm{i}\, \hbar \pdv{\hat{p}_{\text{H}}(t)}{t} = [\hat{p}_{\text{H}}(t), \hat{H}_{\text{H}}(t)] = 0
\end{equation}
也就是说$\hat{p}_{\text{H}}(t)$是一个不随时间变化的算符.
这下我们就能求解$\hat{x}_{\text{H}}(t)$了:
\begin{equation}
  \hat{x}_{\text{H}}(t) = \hat{x}_{\text{H}}(t_0) + \frac{\hat{p}_{\text{H}}(t_0)}{m}  (t - t_0)
\end{equation}
\fr{这实际上与我们经典力学中的结果高度相似}.

根据这个例子, 我们也注意到, 虽然理论很优雅, 但是有几个问题还是无法系统性的解决:
\begin{enumerate}
\item 我们还是没办法解决Hamiltonian出现在指数上的这个问题, 因为一旦出现在指数上, 就得无穷级数展开.
\item 我们要计算大量对易, 而且计算这些对易也完全由$\hat{U}$决定.
\end{enumerate}
所以Heisenberg绘景也不比Schrödinger绘景好多少.

这样我们就有了一个折中的办法, 就是\fr{将Schrödinger绘景和Heisenberg绘景结合起来}, 也就是\fr{相互作用绘景} (interaction picture).
相互作用绘景实际上就是为了能使用扰动方法来展开Dyson级数的一种妥协.
我们现在聚焦在Schrödinger绘景, 然后为了篇幅, 就不特意写出来下标了.
我们现在从$\hat{U}^\dagger$的意义入手:
\begin{equation}
	\hat{U}^\dagger(t,t_0) \ket{\Psi;t} = \hat{U}^\dagger(t, t_0)\hat{U}(t, t_0) \ket{\Psi;0} = \ket{\Psi;0}
\end{equation}
如果是不含时的Hamiltonian问题, 我们有:
\begin{equation}
	\hat{U}_0(t, t_0) = \exp(-\frac{\mathrm{i}}{\hbar} \hat{H}_0 (t-t_0))
\end{equation}
现在引入含时问题: $\hat{H}(t) = \hat{H}_0 + \delta\hat{H}(t)$, 其中$\hat{H}_0$是一个不随时间变化的Hamiltonian, $\delta\hat{H}(t)$是一个随时间变化的项.
我们选择不把$\ket{\Psi;t}$完全的通过$\hat{U}^\dagger(t,t_0)$算符完全的还原到$t_0$时刻的态.
退而求其次, 我们引入:
\begin{equation}
	\ket{\tilde{\Psi};t} = \exp(\frac{i}{\hbar} \hat{H}^{(0)} t) \ket{\Psi;t}
\end{equation}
就是说, 我们部分地把$\ket{\Psi;t}$利用不含时的$\hat{H}_0$, 还原到一个新态$\ket{\tilde{\Psi};t}$.
当然, 在$t=0$的时候, 我们总有:
\begin{equation}
	\ket{\tilde{\Psi};0} = \ket{{\Psi};0}
\end{equation}
现在试着找到$\ket{\tilde{\Psi};t}$, 我们计算:
\begin{equation}
	i\hbar \pdv{}{t} \ket{\tilde{\Psi};t} = -\hat{H}_0 \exp(\frac{i}{\hbar} \hat{H}_0 t) \ket{{\Psi};t} + \exp(\frac{i}{\hbar} \hat{H}_0 t) i\hbar \pdv{}{t}\ket{{\Psi};t}
\end{equation}
利用$\ket{{\Psi};t}$的Schrödinger方程:
\begin{equation}
	i\hbar \pdv{}{t} \ket{\tilde{\Psi};t} = -\hat{H}_0\ket{\tilde{\Psi};t} + \exp(\frac{i}{\hbar} \hat{H}_0 t) \pqty{\hat{H}_0+\delta\hat{H}(t)}\ket{{\Psi};t}
\end{equation}
把最后一项的$\ket{{\Psi};t}$变掉:
\begin{small}
\begin{equation}
	i\hbar \pdv{}{t} \ket{\tilde{\Psi};t} = \bqty{ -\hat{H}_0 + \exp(\frac{i}{\hbar} \hat{H}_0 t) \pqty{\hat{H}_0+\delta\hat{H}(t)} \exp(-\frac{i}{\hbar} \hat{H}_0 t) } \ket{\tilde{\Psi};t}
\end{equation}
\end{small}
注意中括号里第二项, 完全可以和第一个消去:
\begin{equation}
	i\hbar \pdv{}{t} \ket{\tilde{\Psi};t} = \exp(\frac{i}{\hbar} \hat{H}_0 t) \delta\hat{H}(t) \exp(-\frac{i}{\hbar} \hat{H}_0 t) \ket{\tilde{\Psi};t}
\end{equation}
如果我们再定义一个新的绘景:
\begin{equation}
	\delta{\tilde{H}}(t)=\exp(\frac{i}{\hbar} \hat{H}_0 t) \delta\hat{H}(t) \exp(-\frac{i}{\hbar} \hat{H}_0 t)
\end{equation}
我们就可以把这个新的态$\ket{\tilde{\Psi};t}$也找到一个演化方程:
\begin{equation}
	i\hbar \pdv{}{t} \ket{\tilde{\Psi};t} = \delta\tilde{H}(t)\ket{\tilde{\Psi};t}
\end{equation}
这个绘景被成为相互作用绘景.


\begin{definition}[][相互作用绘景]
  相互作用绘景是将Schrödinger绘景和Heisenberg绘景结合起来的一种方法, 他将态和算符都随着时间演化.
  我们的一般的Hamiltonian可以分成两部分:
  \begin{equation}
    \hat{H}_{\text{S}}(t) = \hat{H}_{0, \text{S}} + V_{\text{S}}(t)
  \end{equation}
  然后我们可以定义相互作用绘景下的算符:
  \begin{equation}
    \hat{A}_{\text{I}}(t) = \hat{U}_0^\dagger(t,t_0) \hat{A}_{\text{S}}(t) \hat{U}_0(t,t_0)
  \end{equation}
  其中$\hat{U}_0(t,t_0)$是已知可解的不含时的Hamiltonian给出的时间演化算符, $\hat{A}_{\text{S}}(t)$是Schrödinger绘景下的算符.
  态的演化由如下方程给出:
  \begin{equation}
    i\hbar \pdv{}{t} \ket{\Psi_I;t} = \hat{V}_{\text{I}}(t)\ket{\Psi_I;t}
  \end{equation}
  然后我们通过逆变换找到$\ket{\Psi;t}$:
  \begin{equation}
    \ket{\Psi;t} = \exp(-\frac{i}{\hbar} \hat{H}_0 t) \ket{\Psi_I;t}
  \end{equation}
\end{definition}
我们不再使用$\ket{\tilde{\Psi};t}$ ,$\tilde{\hat{A}}$, 而是使用$\ket{\Psi_I;t}$, $\hat{A}_{\text{I}}(t)$了.


有一个非常简单清晰的例子, 就是NMR效应.
一个磁距在磁场中的Hamiltonian写为:
\begin{equation}
	\hat{H} = \omega_x \hat{S}_x + \omega_y \hat{S}_y + \omega_z \hat{S}_z
\end{equation}
首先我们加一个$B_z$, 产生一个不含时的Hamiltonian:
\begin{equation}
	\hat{H}_0 = \omega_0 \hat{S}_z
\end{equation}
然后在加入旋转磁场:
\begin{equation}
	\hat{H}_{\text{I}}(t)=\Omega \pqty{\hat{S}_x\cos\omega_0t+\hat{S}_y\sin\omega_0t}
\end{equation}
假设磁距一开始的态为:$\ket{\Psi;0}$, $t$时刻他的态是什么?
立刻使用相互作用绘景:
\begin{equation}
	\hat{H}_{\text{I}}(t) = \exp(\frac{i}{2} \omega_0t \sigma_z )\Omega \pqty{\hat{S}_x\cos\omega_0t+\hat{S}_y\sin\omega_0t}\exp(-\frac{i}{2} \omega_0t \sigma_z )
\end{equation}
处理这些Pauli矩阵可以使用附录A中的Pauli乘法表格.
我们有:
\begin{equation}
	\hat{H}_{\text{I}}(t) = \Omega \hat{S}_x
\end{equation}
这就不是个含时的东西, 很好! 我们立刻写出:
\begin{equation}
	\ket{\Psi_{\text{I}};t} = \exp(-\frac{i}{\hbar}\hat{H}_{\text{I}} t )\ket{\Psi_{\text{I}};0} = \exp(-\frac{i}{2}\Omega t \sigma_x )\ket{\Psi_{\text{I}};0}
\end{equation}
然后再变回去:
\begin{equation}
	\ket{\Psi;t} = \exp(-\frac{i}{2}\omega_0 t \sigma_z )\exp(-\frac{i}{2}\Omega t \sigma_x )\ket{\Psi;0}
\end{equation}

现在我们来用相互作用绘景来解决之前说的Dyson级数的问题.
当然, 我们必须承认\fr{我们还得依赖于微扰的方法, 不能处理强扰动问题}.
我们的起点是把Hamiltonian分成两部分:
\begin{equation}
  \hat{H} = \hat{H}_0 + \hat{V}(t)
\end{equation}
这次我们使用了$\hat{V}(t)$来表示时间相关的扰动, 和其他文献对应起来, 其中我们的$\hat{H}_0$是一个不随时间变化的Hamiltonian, 而且本征谱可解.
使用相互作用绘景, 我们有:
\begin{equation}
  \hat{H}_{\text{I}}(t) = \hat{U}_0^\dagger(t,t_0) \hat{V}(t) \hat{U}_0(t,t_0)
\end{equation}
态变成:
\begin{equation}
  \ket{\Psi_{\text{I}};t} = \hat{U}_0^\dagger(t,t_0) \ket{\Psi_{\text{S}};t}
\end{equation}
态的演化满足:
\begin{equation}
  \mathrm{i}\,\hbar \pdv{}{t} \ket{\Psi_{\text{I}};t} = \hat{V}_{\text{I}}(t) \ket{\Psi_{\text{I}};t}
\end{equation}
迄今为止, 我们就是重新抄了一遍定义.
但是我们注意到:
\begin{equation}
  \ket{\Psi_{\text{I}};t} = \hat{U}_{\text{I}}(t,t_0) \ket{\Psi_{\text{I}};t_0}
\end{equation}
这个还是可以迭代求解, 从零阶开始:
\begin{equation}
  \hat{U}_{\text{I}}^{(0)}(t,t_0) = \mathbb{I}
\end{equation}
第一阶:
\begin{equation}
  \hat{U}_{\text{I}}^{(1)}(t,t_0) = \mathbb{I} + \frac{1}{\mathrm{i}\,\hbar} \int_{t_0}^{t} \hat{V}_{\text{I}}(t_1) \dd{t_1}
\end{equation}
第二阶:
\begin{align}
  \hat{U}_{\text{I}}^{(2)}(t,t_0) &= \mathbb{I} + \frac{1}{\mathrm{i}\,\hbar} \int_{t_0}^{t} \hat{V}_{\text{I}}(t_1) \dd{t_1} + \frac{1}{(\mathrm{i}\,\hbar)^2} \int_{t_0}^{t} \int_{t_0}^{t_1} \hat{V}_{\text{I}}(t_1) \hat{V}_{\text{I}}(t_2) \dd{t_2} \dd{t_1}
\end{align}
第三阶:
\begin{align}
  \hat{U}_{\text{I}}^{(3)}(t,t_0) &= \mathbb{I} + \frac{1}{\mathrm{i}\,\hbar} \int_{t_0}^{t} \hat{V}_{\text{I}}(t_1) \dd{t_1} + \frac{1}{(\mathrm{i}\,\hbar)^2} \int_{t_0}^{t} \int_{t_0}^{t_1} \hat{V}_{\text{I}}(t_1) \hat{V}_{\text{I}}(t_2) \dd{t_2} \dd{t_1} \\
  &\quad + \frac{1}{(\mathrm{i}\,\hbar)^3} \int_{t_0}^{t} \int_{t_0}^{t_1} \int_{t_0}^{t_2} \hat{V}_{\text{I}}(t_1) \hat{V}_{\text{I}}(t_2) \hat{V}_{\text{I}}(t_3) \dd{t_3} \dd{t_2} \dd{t_1}
\end{align}
依次类推到第$n$阶, 我们有:
\begin{equation}
  \hat{U}_{\text{I}}^{(n)}(t,t_0) = \mathbb{I} + \sum_{k=1}^{n} \frac{1}{(\mathrm{i}\,\hbar)^k} \int_{t_0}^{t} \int_{t_0}^{t_1} \cdots \int_{t_0}^{t_{(k-1)}} \hat{V}_{\text{I}}(t_1) \hat{V}_{\text{I}}(t_2) \cdots \hat{V}_{\text{I}}(t_k) \dd{t_k} \dd{t_{k-1}} \cdots \dd{t_1}
\end{equation}
当$n$趋于无穷大时, 我们就得到了Dyson级数:
%==========
\begin{fancybox}
\begin{equation}
  \hat{U}_{\text{I}}(t,t_0) = \mathcal{T} \exp\left( -\frac{\mathrm{i}}{\hbar} \int_{t_0}^{t} \hat{V}_{\text{I}}(t_1) \dd{t_1} \right)
\end{equation}
这个就是相互作用绘景下的时间演化算符.
\end{fancybox}
%==========


现在我们来讨论一下相互作用绘景一个非常重要的应用, 就是Fermi's Golden Rule.
我们考虑初始时刻的态为$\ket{\Psi_{\text{I}};t_0}$, 他是一个本征态, 也就是:
\begin{equation}
  \ket{\Psi_{\text{I}};t_0} = \ket{\psi_{\text{i}}} \quad \hat{H}_0 \ket{\psi_{\text{i}}} = E_i \ket{\psi_{\text{i}}}
\end{equation}
然后我们考虑在之后的时刻$t$时刻, 我们的态写为:
\begin{equation}
  \ket{\Psi_{\text{I}};t} = \hat{U}_{\text{I}}(t,t_0) \ket{\Psi_{\text{I}};t_0} = \hat{U}_{\text{I}}(t,t_0) \ket{\psi_{\text{i}}}
\end{equation}
然后我们在时刻$t$时刻, 进行瞬时本征态展开:
\begin{equation}
  \ket{\Psi_{\text{I}};t} = \sum_n c_n(t) \ket{\psi_n} \quad c_n(t) = \mel{\psi_n}{\hat{U}_{\text{I}}(t,t_0)}{\psi_i}
\end{equation}
对于一个我们特别关心的末本征态$\ket{\psi_{\text{f}}}$, 我们有:
\begin{equation}
  c_f(t) = \mel{\psi_{\text{f}}}{\hat{U}_{\text{I}}(t,t_0)}{\psi_{\text{i}}}
\end{equation}
这个时候我们就需要考虑$\hat{U}_{\text{I}}(t,t_0)$的形式了, 我们有:
\begin{equation}
  \hat{U}_{\text{I}}(t,t_0) = \mathcal{T} \exp\left( -\frac{\mathrm{i}}{\hbar} \int_{t_0}^{t} \hat{V}_{\text{I}}(t_1) \dd{t_1} \right)
\end{equation}
考虑到第一阶扰动展开:
\begin{equation}
  \hat{U}_{\text{I}}(t,t_0) \approx \mathbb{I} - \frac{\mathrm{i}}{\hbar} \int_{t_0}^{t} \hat{V}_{\text{I}}(t_1) \dd{t_1}
\end{equation}
我们可以将这个式子代入到$c_{\text{f}}(t)$中:
\begin{equation}
  c_f(t) \approx \mel{\psi_{\text{f}}}{\mathbb{I} - \frac{\mathrm{i}}{\hbar} \int_{t_0}^{t} \hat{V}_{\text{I}}(t_1) \dd{t_1}}{\psi_{\text{i}}}
\end{equation}
我们有:
\begin{equation}
  c_f(t) \approx \braket{\psi_{\text{f}}}{\psi_{\text{i}}} - \frac{\mathrm{i}}{\hbar} \int_{t_0}^{t} \mel{\psi_{\text{f}}}{\hat{V}_{\text{I}}(t_1)}{\psi_{\text{i}}} \dd{t_1}
\end{equation}
注意到$\braket{\psi_{\text{f}}}{\psi_{\text{i}}} = \delta_{\text{fi}}$, 当然我们一般关心的是$\text{f} \neq \text{i}$, 所以这个项为0.
我们有:
\begin{equation}
  c_{\text{f}}(t) \approx - \frac{\mathrm{i}}{\hbar} \int_{t_0}^{t} \mel{\psi_{\text{f}}}{\hat{V}_{\text{I}}(t_1)}{\psi_{\text{i}}} \dd{t_1}
\end{equation}
现在我们需要计算矩阵元:
\begin{equation}
  \mel{\psi_{\text{f}}}{\hat{V}_{\text{I}}(t_1)}{\psi_{\text{i}}} = \mel{\psi_{\text{f}}}{\exp(\frac{\mathrm{i}}{\hbar} \hat{H}_0 t_1) \hat{V}(t_1) \exp(-\frac{\mathrm{i}}{\hbar} \hat{H}_0 t_1)}{\psi_{\text{i}}}
\end{equation}
$\hat{H}_0$作用在态上是可以直接写出来的:
\begin{equation}
  \mel{\psi_{\text{f}}}{\hat{V}_{\text{I}}(t_1)}{\psi_{\text{i}}} = \mel{\psi_{\text{f}}}{\hat{V}(t_1)}{\psi_{\text{i}}} \exp\left( -\frac{\mathrm{i}}{\hbar} (E_{\text{f}} - E_{\text{i}}) t_1 \right)
\end{equation}
从而我们的$c_{\text{f}}(t)$变成:
\begin{equation}
  c_{\text{f}}(t) \approx - \frac{\mathrm{i}}{\hbar} \int_{t_0}^{t} \mel{\psi_{\text{f}}}{\hat{V}(t_1)}{\psi_{\text{i}}} \exp\left( -\frac{\mathrm{i}}{\hbar} (E_{\text{f}} - E_{\text{i}}) t_1 \right) \dd{t_1}
\end{equation}
我们考虑势能是不含时的, 我们有:
\begin{equation}
  \mel{\psi_{\text{f}}}{\hat{V}(t_1)}{\psi_{\text{i}}} = \mel{\psi_{\text{f}}}{\hat{V}}{\psi_{\text{i}}}
\end{equation}
然后可以求积分了:
\begin{equation}
  c_{\text{f}}(t) \approx - \frac{\mathrm{i}}{\hbar} \mel{\psi_{\text{f}}}{\hat{V}}{\psi_{\text{i}}} \int_{t_0}^{t} \exp\left( -\frac{\mathrm{i}}{\hbar} (E_{\text{f}} - E_{\text{i}}) t_1 \right) \dd{t_1}
\end{equation}
我们可以计算这个积分:
\begin{equation}
  \int_{t_0}^{t} \exp\left( -\frac{\mathrm{i}}{\hbar} (E_f - E_i) t_1 \right) \dd{t_1} = -\frac{\hbar}{\mathrm{i}(E_{\text{f}} - E_{\text{i}})} \left[ \exp\left( -\frac{\mathrm{i}}{\hbar} (E_{\text{f}} - E_{\text{i}}) t_1 \right) \right]_{t_0}^{t}
\end{equation}
将这个结果代入到$c_{\text{f}}(t)$中, 我们得到:
\begin{align}
  c_{\text{f}}(t) \approx& - \frac{\mathrm{i}}{\hbar} \mel{\psi_{\text{f}}}{\hat{V}}{\psi_{\text{i}}} \left( -\frac{\hbar}{\mathrm{i}(E_f - E_i)} \left[ \exp\left( -\frac{\mathrm{i}}{\hbar} (E_{\text{f}} - E_{\text{i}}) t_1 \right) \right]_{t_0}^{t} \right) \\
  =& \frac{\mel{\psi_{\text{f}}}{\hat{V}}{\psi_{\text{i}}}}{E_{\text{f}} - E_{\text{i}}} \left( \exp\left( -\frac{\mathrm{i}}{\hbar} (E_{\text{f}} - E_{\text{i}}) t \right) - \exp\left( -\frac{\mathrm{i}}{\hbar} (E_{\text{f}} - E_{\text{i}}) t_0 \right) \right)
\end{align}
我们对后面的因子进行一些变换:
\begin{equation}
  \omega_{\text{fi}} = \frac{E_{\text{f}} - E_{\text{i}}}{\hbar}
\end{equation}
从而我们有:
\begin{equation}
  \frac{\mel{\psi_{\text{f}}}{\hat{V}}{\psi_{\text{i}}}}{E_{\text{f}} - E_{\text{i}}} \left( \exp\left( -\frac{\mathrm{i}}{\hbar} (E_{\text{f}} - E_{\text{i}}) t \right) - \exp\left( -\frac{\mathrm{i}}{\hbar} (E_{\text{f}} - E_{\text{i}}) t_0 \right) \right) = \frac{\mel{\psi_{\text{f}}}{\hat{V}}{\psi_{\text{i}}}}{\hbar \omega_{\text{fi}}} \left( e^{-\mathrm{i} \omega_{\text{fi}} t} - e^{-\mathrm{i} \omega_{\text{fi}} t_0} \right)
\end{equation}
我们引入时间间隔$T=t - t_0$, 那么我们有:
\begin{equation}
  c_{\text{f}}(t) \approx \frac{\mel{\psi_{\text{f}}}{\hat{V}}{\psi_{\text{i}}}}{\hbar \omega_{\text{fi}}} e^{-\mathrm{i}\,\omega_{\text{fi}} (t+t_0)/2} \left( e^{-\mathrm{i} \omega_{\text{fi}} T/2} - e^{+\mathrm{i} \omega_{\text{fi}} T/2} \right)
\end{equation}
这就是:
\begin{equation}
  c_{\text{f}}(t) \approx -2 \mathrm{i}\, \frac{\mel{\psi_{\text{f}}}{\hat{V}}{\psi_{\text{i}}}}{\hbar \omega_{\text{fi}}} e^{-\mathrm{i}\,\omega_{\text{fi}} (t+t_0)/2} \sin\left( \frac{\omega_{\text{fi}} T}{2} \right)
\end{equation}
现在我们提问, 在$t$时刻, 我们获得本征态$\ket{\psi_{\text{f}}}$的概率是多少?
这由系数$c_{\text{f}}(t)$的模方给出:
\begin{equation}
  P_{\text{fi}}(t) = \|c_{\text{f}}(t)\|^2 = 4 \left( \frac{\|\mel{\psi_{\text{f}}}{\hat{V}}{\psi_{\text{i}}}\|}{\hbar \omega_{\text{fi}}} \right)^2 \sin^2\left( \frac{\omega_{\text{fi}} T}{2} \right)
\end{equation}
这个就是Fermi's Golden Rule.
当然这个东西还是没法直接用, 所以我们必须考虑长时间极限, 也就是$T \to \infty$.
\begin{equation}
  4 \sin^2\left( \frac{\omega_{\text{fi}} T}{2} \right)\frac{1}{\hbar^2 \omega^2_{\text{fi}}} \to  \frac{2\pi}{\hbar} T \delta(E_{\text{f}} - E_{\text{i}})
\end{equation}
我们有:
\begin{equation}
  P_{\text{fi}}(t) = \frac{2\pi}{\hbar} T \|\mel{\psi_{\text{f}}}{\hat{V}}{\psi_{\text{i}}}\|^2 \delta(E_{\text{f}} - E_{\text{i}})
\end{equation}
他的一个重要用途就是获得散射率, (倒数就是散射时间):
\begin{equation}
  \Gamma_{\text{fi}} = \frac{2\pi}{\hbar} \|\mel{\psi_{\text{f}}}{\hat{V}}{\psi_{\text{i}}}\|^2 \delta(E_{\text{f}} - E_{\text{i}})
\end{equation}
这个是准确的从初态到关心末态的散射率.
但是一般末态是可能是一个小区域, 换句话说, 我们要算概率而不是概率密度, 所以我们一般在使用Fermi's Golden Rule时, 都会考虑和末态有关的一小段能量:
\begin{equation}
  \Gamma_{\text{fi}} = \frac{2\pi}{\hbar} \sum_{\text{f}} \|\mel{\psi_{\text{f}}}{\hat{V}}{\psi_{\text{i}}}\|^2 \delta(E_{\text{f}} - E_{\text{i}})
\end{equation}
如果是连续谱的话, 我们就需要积分, 但是要考虑一下末态的能量密度 $\rho(E_{\text{f}})$:
\begin{equation}
  \Gamma_{\text{fi}} = \frac{2\pi}{\hbar} \int \rho(E_{\text{f}}) \|\mel{\psi_{\text{f}}}{\hat{V}}{\psi_{\text{i}}}\|^2 \delta(E_{\text{f}} - E_{\text{i}}) \dd{E_{\text{f}}} 
\end{equation}


我们现在举个简单的例子, 就是考虑两个初态末态都是平面波的情况:
\begin{equation}
  \ket{\psi_{\text{i}}} = \frac{1}{\sqrt{L^3}} e^{\mathrm{i} \bm{k}_{\text{i}} \cdot \bm{x}} \quad \ket{\psi_{\text{f}}} = \frac{1}{\sqrt{L^3}} e^{\mathrm{i} \bm{k}_{\text{f}} \cdot \bm{x}}
\end{equation}
我们的能量守恒为:
\begin{equation}
  E_{\text{i}} = E_{\text{f}} \quad \Rightarrow \quad \frac{\hbar^2 k_{\text{i}}^2}{2m} = \frac{\hbar^2 k_{\text{f}}^2}{2m} \quad \Rightarrow \quad k_{\text{i}}^2 = k_{\text{f}}^2
\end{equation}
我们可以立刻写出来矩阵元:
\begin{equation}
  \mathcal{M}_{\text{fi}} = \mel{\psi_{\text{f}}}{\hat{V}}{\psi_{\text{i}}} = \frac{1}{L^3} \int e^{-\mathrm{i} \bm{k}_{\text{f}} \cdot \bm{x}} \hat{V} e^{\mathrm{i} \bm{k}_{\text{i}} \cdot \bm{x}} \dd[3]{x} = \frac{\tilde{V}(\bm{k}_{\text{f}} - \bm{k}_{\text{i}})}{L^3}
\end{equation}
从而我们可以写出微分跃迁率:
\begin{equation}
  w_{\text{fi}} = \frac{2\pi}{\hbar} \|\mathcal{M}_{\text{fi}}\|^2 \delta(E_{\text{f}} - E_{\text{i}})
\end{equation}
在三维动量空间中, 每个末态占据体积$\frac{(2\pi)^3}{L^3}$, 所以我们有:
\begin{equation}
  \dd{N_{\text{f}}} = \frac{L^3}{(2\pi)^3} \dd[3]{k_{\text{f}}}
\end{equation}
从而我们有:
\begin{equation}
  \dd{W} = w_{\text{fi}} \dd{N_{\text{f}}} = \frac{2\pi}{\hbar} \|\mathcal{M}_{\text{fi}}\|^2 \delta(E_{\text{f}} - E_{\text{i}}) \frac{L^3}{(2\pi)^3} \dd[3]{k_{\text{f}}} = \frac{2\pi}{\hbar} \|\mathcal{M}_{\text{fi}}\|^2 \delta(E_{\text{f}} - E_{\text{i}}) \frac{L^3}{(2\pi)^3} k_{\text{f}}^2 \dd{k_{\text{f}}} \dd{\Omega_{\text{f}}}
\end{equation}
其中:
\begin{equation}
  \dd{\Omega_{\text{f}}} = \sin\theta_{\text{f}} \dd{\theta_{\text{f}}} \dd{\phi_{\text{f}}}
\end{equation}
我们对于$\dd{W}$进行关于$k_{\text{f}}$的积分, 我们有:
\begin{equation}
  \dd{W} = \int \frac{2\pi}{\hbar} \|\mathcal{M}_{\text{fi}}\|^2 \delta(E_{\text{f}} - E_{\text{i}}) \frac{L^3}{(2\pi)^3} k_{\text{f}}^2 \dd{k_{\text{f}}} \dd{\Omega_{\text{f}}} = \frac{2\pi}{\hbar} \frac{m k_i}{\hbar^2} \frac{L^3}{(2\pi)^3} \|\mathcal{M}_{\text{fi}}\|^2 \dd{\Omega_{\text{f}}}
\end{equation}
我们可以写出单位体积的粒子入射流, 入射流的物理意义是每单位面积, 每单位时间有多少粒子通过.
其实就是波函数的概率流密度, 定义为:
\begin{equation}
  \bm{j}=\frac{\hbar}{2 m i}\left(\Psi_i^* \nabla \Psi_i-\Psi_i \nabla \Psi_i^*\right)
\end{equation}
根据上面的定义, 就带入平面波的表达式, 我们有(只考虑了大小):
\begin{equation}
  j = \frac{\hbar k_{\text{i}}}{mL^3}
\end{equation}
我们可以计算出散射微分截面:
\begin{equation}
  \dv{\sigma}{\Omega} = \frac{2\pi}{\hbar} \frac{L^3}{(2\pi)^3} \frac{m k_{\text{i}}}{\hbar^2} \|\mathcal{M}_{\text{fi}}\|^2 \frac{m L^3}{\hbar k_i} = \frac{m^2}{4\pi^2 \hbar^4} \|\tilde{V}(\bm{k}_{\text{f}} - \bm{k}_{\text{i}})\|^2
\end{equation}


%====================
%====================
\section{经典场论}
\label{CH1 S6 Classical field theory}
%====================
%====================








